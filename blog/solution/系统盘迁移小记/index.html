<!DOCTYPE html><html><head><meta charset="utf-8" name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-175297541-1"></script><title>系统盘迁移小记</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="/content/css/styles.css?v=202102161343"><script src="/content/js/header.js?v=202102080708"></script><link rel="alternate" href="/atom.xml" title="Mark Ma's Blog" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="Mark Ma's Blog" type="application/rss+xml"></head><body onclick=""><div class="sidebar" id="sidebar" onclick=""><div class="sidebar-item"><h1 style="margin-top:1.6em">Mark Ma&#39;s Blog</h1></div><nav class="sidebar-nav"><a class="sidebar-nav-item" href="/">About</a> <a class="sidebar-nav-item" href="/blog/">Blog</a> <a class="sidebar-nav-item" href="/archive/by-date/">- by Date</a> <a class="sidebar-nav-item" href="/archive/by-category/">- by Category</a> <a class="sidebar-nav-item" href="/archive/by-tag/">- by Tag</a> <a class="sidebar-nav-item" href="/portfolio/">Portfolio</a> <a class="sidebar-nav-item" href="/portfolio/graphic-design/">- Graphic Design</a> <a class="sidebar-nav-item" href="/portfolio/video-composition/">- Video Composition</a> <a class="sidebar-nav-item" href="/portfolio/web-design/">- Web Design</a><div class="sidebar-nav-item" onclick="switchColorMode()" style="cursor:pointer">Dark Mode</div></nav><div class="sidebar-item"><p><a href="/privacy-policy/" style="color:#888;font-size:.85em">Privacy Policy</a></p><p>&copy; 2017-2021. All rights reserved.</p></div></div><div class="markdown-body"><article id="post-md/2018-03-26-系统盘迁移小记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="article-inner"><header class="article-header"><h1 class="p-name article-title" itemprop="headline name">系统盘迁移小记</h1></header><p class="post-meta"><time class="dt-published" datetime="2018-03-26T14:48:00+08:00" itemprop="datePublished">2018-03-26</time></p><div class="e-content article-entry" itemprop="articleBody"><p>帮舍友迁移系统（Win10）。新买的固态，需要把hdd上的C盘完整复制过去。</p><p>舍友电脑上没有ngff接口，所以买了sata口的固态，需要把原硬盘挪到光驱位，再把固态放到原硬盘位。</p><p>硬件搞定直接开机，还是从机械硬盘启动，给固态指定盘符然后测速——固态倒是没什么问题，但后来才意识到这一步正是作死第一步。</p><a id="more"></a><p>在PE使用某分区助手直接迁移系统。因为光驱位是sata2的，所以速度特别慢。所以下次可以考虑直接上usb3.0的硬盘盒来做这一步。</p><p>迁移完系统，PE修复UEFI引导（在固态上之前预留的区），指定了从固态启动，BIOS指定启动的EFI。结果开机发现还是从机械启动的。于是把机械硬盘的C盘格了——作死第二步。</p><p>再开机始终卡黑屏，就一个鼠标。反复强制重启两次以后出现磁盘修复界面，“Windows正在扫描并修复磁盘(G:)”。</p><p>愣了一秒以后意识到，出大事了。测速时候给固态指定的盘符G，一定以某种方式记录在了系统中，Windows试图从G盘启动，但是系统根据盘符认为程序都应该在被格调的机械C盘里，因此只有内核加载了，登陆界面大概永远也不出来了。</p><p>Google如何修改盘符，正如猜测，盘符记录在注册表里。根据教程，只需要把System部分拷贝到别的Win下用Regedit挂载就可以修改。奇怪的是无论是PE还是我的Win10都挂载不了我舍友的注册表，显示Error while loading hive.</p><p>期间尝试了用十六进制编辑器直接修改注册表文件，未果。后来猜想可能是改的还不够彻底，下次可以尝试用Decoder把二进制解码了再对照修改。</p><p>总之，最后用了Win8.1的官方原版安装盘成功挂载上了注册表。这一步是靠运气，因为实在查不到挂载不了注册表的原因，随便试了一下居然成功了。</p><p>后面就很简单了。</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices\</code></pre><p>删除全部其中的键值，Win会自动重分配。</p><h4 id="经验">经验</h4><ul><li>迁移系统前如果给新盘分配了盘符一定要记得删除。</li><li>保险起见可以在PE里测试新盘。</li><li>机械硬盘还是要小心。。。挪完系统舍友的机械硬盘挂掉了，除了C盘数据之前挪到了SSD，剩下全都没了。</li></ul></div></div></article></div><div id="privacy-notice"><div id="privacy-notice-content" class="markdown-body"><div><a id="privacy-notice-dismiss" class="btn"><svg width="18" height="18" viewBox="0 0 18 18" style="fill:currentColor;vertical-align:baseline;margin-top:-.3em;margin-bottom:-.3em"><path d="M15 4.41L13.59 3 9 7.59 4.41 3 3 4.41 7.59 9 3 13.59 4.41 15 9 10.41 13.59 15 15 13.59 10.41 9 15 4.41z"/></svg></a></div><div>Hover your mouse or tap on the left edge to navigate.<br>Upon dismissing, you acknowledge that you have read and understand our <a href="/privacy-policy/">Privacy Policy</a>.</div></div></div></body><footer><script src="/content/js/footer.js?v=202102080708"></script></footer></html>