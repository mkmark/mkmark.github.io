<!DOCTYPE html><html><head><meta charset="utf-8" name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-175297541-1"></script><title>苏康码自动申报</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="/content/css/styles.css?v=202102162213"><script src="/content/js/header.js?v=202102080708"></script><link rel="alternate" href="/atom.xml" title="Mark Ma's Blog" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="Mark Ma's Blog" type="application/rss+xml"></head><body onclick=""><div class="sidebar" id="sidebar" onclick=""><div class="sidebar-item"><h1 style="margin-top:1.6em">Mark Ma&#39;s Blog</h1></div><nav class="sidebar-nav"><a class="sidebar-nav-item" href="/">About</a> <a class="sidebar-nav-item" href="/blog/">Blog</a> <a class="sidebar-nav-item" href="/archive/by-date/">　by Date</a> <a class="sidebar-nav-item" href="/archive/by-category/">　by Category</a> <a class="sidebar-nav-item" href="/archive/by-tag/">　by Tag</a> <a class="sidebar-nav-item" href="/portfolio/">Portfolio</a> <a class="sidebar-nav-item" href="/archive/by-tag/civil-engineering/">　Civil Engineering</a> <a class="sidebar-nav-item" href="/portfolio/graphic-design/">　Graphic Design</a> <a class="sidebar-nav-item" href="/portfolio/video-composition/">　Video Composition</a> <a class="sidebar-nav-item" href="/portfolio/web-design/">　Web Design</a><div class="sidebar-nav-item" onclick="switchColorMode()" style="cursor:pointer">Dark Mode</div></nav><div class="sidebar-item"><p><a href="/privacy-policy/" style="font-size:.85em">Privacy Policy</a></p><p>&copy; 2017-2021. All rights reserved.</p></div></div><div class="markdown-body"><article id="post-md/2021-03-15-苏康码自动申报" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="article-inner"><header class="article-header"><h1 class="p-name article-title" itemprop="headline name">苏康码自动申报</h1></header><p class="post-meta"><time class="dt-published" datetime="2021-03-15T08:41:00+00:00" itemprop="datePublished">2021-03-15</time></p><div class="e-content article-entry" itemprop="articleBody"><p><a target="_blank" rel="noopener" href="https://gist.github.com/mkmark/e73783a3351da0c7f0265fb474b3db68">https://gist.github.com/mkmark/e73783a3351da0c7f0265fb474b3db68</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># %%</span>
<span class="token keyword">import</span> http<span class="token punctuation">.</span>cookiejar
<span class="token keyword">import</span> json
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">import</span> ssl
<span class="token keyword">import</span> urllib
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> ssl
<span class="token keyword">import</span> dateutil<span class="token punctuation">.</span>tz

<span class="token comment"># %%</span>
ssl<span class="token punctuation">.</span>_create_default_https_context <span class="token operator">=</span> ssl<span class="token punctuation">.</span>_create_unverified_context
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>cookie <span class="token operator">=</span> http<span class="token punctuation">.</span>cookiejar<span class="token punctuation">.</span>CookieJar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>handler <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>HTTPCookieProcessor<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>opener <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>build_opener<span class="token punctuation">(</span>self<span class="token punctuation">.</span>handler<span class="token punctuation">)</span>
        urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>install_opener<span class="token punctuation">(</span>self<span class="token punctuation">.</span>opener<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">read_cookie</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cookie_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cookie'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
        cookie <span class="token operator">=</span> cookie_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> cookie

    <span class="token keyword">def</span> <span class="token function">write_cookie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cookie<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cookie_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cookie'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
        cookie_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">userAuth</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cookie <span class="token operator">=</span> self<span class="token punctuation">.</span>read_cookie<span class="token punctuation">(</span><span class="token punctuation">)</span>
        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'Origin'</span><span class="token punctuation">:</span> <span class="token string">'https://jsstm.jszwfw.gov.cn'</span><span class="token punctuation">,</span>
            <span class="token string">'Cookie'</span><span class="token punctuation">:</span> cookie<span class="token punctuation">,</span>
            <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/javascript, */*; q=0.01'</span><span class="token punctuation">,</span>
            <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; U; Android 10; zh-CN; MIX 2S Build/QKQ1.190828.002) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 UWS/3.22.2.1 Mobile Safari/537.36 AlipayChannelId/5136 UCBS/3.22.2.1_210128135804 NebulaSDK/1.8.100112 Nebula AlipayDefined(nt:WIFI,ws:480|0|2.25) AliApp(AP/10.2.15.9342) AlipayClient/10.2.15.9342 Language/en useStatusBar/true isConcaveScreen/false Region/CN MiniProgram APXWebView NebulaX/1.0.0 Ariver/1.0.0'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://jsstm.jszwfw.gov.cn/jkmIndex.html?token=【token】&amp;jszwuserid=【uuid】&amp;uuid=【uuid2】'</span><span class="token punctuation">,</span>
            <span class="token string">'x-mass-tappid'</span><span class="token punctuation">:</span> <span class="token string">'2018062060350751'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded; charset=UTF-8'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Length'</span><span class="token punctuation">:</span> <span class="token string">'115'</span><span class="token punctuation">,</span>
            <span class="token string">'Host'</span><span class="token punctuation">:</span> <span class="token string">'jsstm.jszwfw.gov.cn'</span><span class="token punctuation">,</span>
            <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'Keep-Alive'</span>
        <span class="token punctuation">&#125;</span>
        request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span><span class="token string">"https://jsstm.jszwfw.gov.cn/jkm/userAuth"</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token string">"fail"</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>getcode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'userAuth success!'</span><span class="token punctuation">)</span>
            cookie <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Set-Cookie"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>write_cookie<span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

            response_dict <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            abc <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">"res"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"userdetail"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">]</span>
            urlabc <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>abc<span class="token punctuation">)</span>
            result <span class="token operator">=</span> urlabc
        <span class="token keyword">return</span> result

    <span class="token keyword">def</span> <span class="token function">queryAttendanceList</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cookie <span class="token operator">=</span> self<span class="token punctuation">.</span>read_cookie<span class="token punctuation">(</span><span class="token punctuation">)</span>
        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'Origin'</span><span class="token punctuation">:</span> <span class="token string">'https://jsstm.jszwfw.gov.cn'</span><span class="token punctuation">,</span>
            <span class="token string">'Cookie'</span><span class="token punctuation">:</span> cookie<span class="token punctuation">,</span>
            <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/javascript, */*; q=0.01'</span><span class="token punctuation">,</span>
            <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; U; Android 10; zh-CN; MIX 2S Build/QKQ1.190828.002) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 UWS/3.22.2.1 Mobile Safari/537.36 AlipayChannelId/5136 UCBS/3.22.2.1_210128135804 NebulaSDK/1.8.100112 Nebula AlipayDefined(nt:WIFI,ws:480|0|2.25) AliApp(AP/10.2.15.9342) AlipayClient/10.2.15.9342 Language/en useStatusBar/true isConcaveScreen/false Region/CN MiniProgram APXWebView NebulaX/1.0.0 Ariver/1.0.0'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://jsstm.jszwfw.gov.cn/jkmIndex.html?token=【token】&amp;jszwuserid=【uuid】&amp;uuid=【uuid2】'</span><span class="token punctuation">,</span>
            <span class="token string">'x-mass-tappid'</span><span class="token punctuation">:</span> <span class="token string">'2018062060350751'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded; charset=UTF-8'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Length'</span><span class="token punctuation">:</span> <span class="token string">'78'</span><span class="token punctuation">,</span>
            <span class="token string">'Host'</span><span class="token punctuation">:</span> <span class="token string">'jsstm.jszwfw.gov.cn'</span><span class="token punctuation">,</span>
            <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'Keep-Alive'</span>
        <span class="token punctuation">&#125;</span>
        request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span><span class="token string">"https://jsstm.jszwfw.gov.cn/day/queryAttendanceList"</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token string">"fail"</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>getcode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'queryAttendanceList success!'</span><span class="token punctuation">)</span>
            cookie <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Set-Cookie"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>write_cookie<span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

            response_dict <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            timestamp <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">"res"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"createtime"</span><span class="token punctuation">]</span>
            result <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcfromtimestamp<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">saveDailyAttendence</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cookie <span class="token operator">=</span> self<span class="token punctuation">.</span>read_cookie<span class="token punctuation">(</span><span class="token punctuation">)</span>
        headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'Cookie'</span><span class="token punctuation">:</span> cookie<span class="token punctuation">,</span>
            <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/javascript, */*; q=0.01'</span><span class="token punctuation">,</span>
            <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; U; Android 10; zh-CN; MIX 2S Build/QKQ1.190828.002) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 UWS/3.22.2.1 Mobile Safari/537.36 AlipayChannelId/5136 UCBS/3.22.2.1_210128135804 NebulaSDK/1.8.100112 Nebula AlipayDefined(nt:WIFI,ws:480|0|2.25) AliApp(AP/10.2.15.9342) AlipayClient/10.2.15.9342 Language/en useStatusBar/true isConcaveScreen/false Region/CN MiniProgram APXWebView NebulaX/1.0.0 Ariver/1.0.0'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://jsstm.jszwfw.gov.cn/jkmIndex.html?token=【token】&amp;jszwuserid=【uuid】&amp;uuid=【uuid2】'</span><span class="token punctuation">,</span>
            <span class="token string">'x-mass-tappid'</span><span class="token punctuation">:</span> <span class="token string">'2018062060350751'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded; charset=UTF-8'</span><span class="token punctuation">,</span>
            <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span>
            <span class="token string">'Content-Length'</span><span class="token punctuation">:</span> <span class="token string">'317'</span><span class="token punctuation">,</span>
            <span class="token string">'Host'</span><span class="token punctuation">:</span> <span class="token string">'jsstm.jszwfw.gov.cn'</span><span class="token punctuation">,</span>
            <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'Keep-Alive'</span>
        <span class="token punctuation">&#125;</span>
        request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span><span class="token string">"https://jsstm.jszwfw.gov.cn/day/saveDailyAttendance"</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>getcode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'saveDailyAttendence success!'</span><span class="token punctuation">)</span>
            cookie <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Set-Cookie"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>write_cookie<span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

            response_dict <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            response_json <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>response_dict<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>response_json<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">telegrambot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> token<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        request <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span><span class="token string">"https://api.telegram.org/bot"</span> <span class="token operator">+</span> token <span class="token operator">+</span> <span class="token string">"/sendMessage"</span><span class="token punctuation">)</span>
        response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">,</span> data<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> User<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data_userAuth <span class="token operator">=</span> <span class="token string">"token=【token】&amp;uuid=【uuid】&amp;source=alipay"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    urlabc <span class="token operator">=</span> user<span class="token punctuation">.</span>userAuth<span class="token punctuation">(</span>data_userAuth<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>urlabc<span class="token operator">==</span><span class="token string">"fail"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token string">"userAuth fail"</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    data_saveDailyAttendence <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"member_id=【身份证号】&amp;name=【姓名url】&amp;mobile=【手机号】&amp;idType=1&amp;degree=37.3&amp;realtimeLocation=&amp;source=alipay&amp;degree_flag=0&amp;r1data=0&amp;r2data=0&amp;r3data=0&amp;travel=0&amp;r5data=&amp;travel_destination=&amp;travel_time=&amp;travel_duration=&amp;travel_destination_code=&amp;other=&amp;abc="</span> <span class="token operator">+</span> urlabc<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    user<span class="token punctuation">.</span>saveDailyAttendence<span class="token punctuation">(</span>data_saveDailyAttendence<span class="token punctuation">)</span>

    data_queryAttendanceList <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"userId=【身份证号】&amp;abc="</span> <span class="token operator">+</span> urlabc<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    utc <span class="token operator">=</span> user<span class="token punctuation">.</span>queryAttendanceList<span class="token punctuation">(</span>data_queryAttendanceList<span class="token punctuation">)</span>
    from_zone <span class="token operator">=</span> dateutil<span class="token punctuation">.</span>tz<span class="token punctuation">.</span>gettz<span class="token punctuation">(</span><span class="token string">'UTC'</span><span class="token punctuation">)</span>
    to_zone <span class="token operator">=</span> dateutil<span class="token punctuation">.</span>tz<span class="token punctuation">.</span>gettz<span class="token punctuation">(</span><span class="token string">'China/Shang_Hai'</span><span class="token punctuation">)</span>
    utc <span class="token operator">=</span> utc<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>tzinfo<span class="token operator">=</span>from_zone<span class="token punctuation">)</span>
    utcp8 <span class="token operator">=</span> utc<span class="token punctuation">.</span>astimezone<span class="token punctuation">(</span>to_zone<span class="token punctuation">)</span>
    result <span class="token operator">=</span> utcp8<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></code></pre></div></div></article></div><div id="privacy-notice"><div id="privacy-notice-content" class="markdown-body"><div><a id="privacy-notice-dismiss" class="btn"><svg width="18" height="18" viewBox="0 0 18 18" style="fill:currentColor;vertical-align:baseline;margin-top:-.3em;margin-bottom:-.3em"><path d="M15 4.41L13.59 3 9 7.59 4.41 3 3 4.41 7.59 9 3 13.59 4.41 15 9 10.41 13.59 15 15 13.59 10.41 9 15 4.41z"/></svg></a></div><div>Hover your mouse or tap on the left edge to navigate.<br>Upon dismissing, you acknowledge that you have read and understand our <a href="/privacy-policy/">Privacy Policy</a>.</div></div></div></body><footer><script src="/content/js/footer.js?v=202102080708"></script></footer></html>