<!DOCTYPE html><html><head><meta charset="utf-8" name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-175297541-1"></script><title>Word 图表标题按章节自动编号</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="/content/css/styles.css?v=202102150856"><script src="/content/js/header.js?v=202102080708"></script><link rel="alternate" href="/atom.xml" title="Mark Ma's Blog" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="Mark Ma's Blog" type="application/rss+xml"></head><body onclick=""><div class="sidebar" id="sidebar" onclick=""><div class="sidebar-item"><h1 style="margin-top:1.6em">Mark Ma&#39;s Blog</h1></div><nav class="sidebar-nav"><a class="sidebar-nav-item" href="/">About</a> <a class="sidebar-nav-item" href="/blog/">Blog</a> <a class="sidebar-nav-item" href="/archive/by-date/">- by Date</a> <a class="sidebar-nav-item" href="/archive/by-category/">- by Category</a> <a class="sidebar-nav-item" href="/archive/by-tag/">- by Tag</a> <a class="sidebar-nav-item" href="/portfolio/">Portfolio</a> <a class="sidebar-nav-item" href="/portfolio/graphic-design/">- Graphic Design</a> <a class="sidebar-nav-item" href="/portfolio/video-composition/">- Video Composition</a> <a class="sidebar-nav-item" href="/portfolio/web-design/">- Web Design</a><div class="sidebar-nav-item" onclick="switchColorMode()" style="cursor:pointer">Dark Mode</div></nav><div class="sidebar-item"><p><a href="/privacy-policy/" style="color:#888;font-size:.85em">Privacy Policy</a></p><p>&copy; 2017-2021. All rights reserved.</p></div></div><div class="markdown-body"><article id="post-md/2018-05-31-word-图表标题按章节自动编号" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="article-inner"><header class="article-header"><h1 class="p-name article-title" itemprop="headline name">Word 图表标题按章节自动编号</h1></header><p class="post-meta"><time class="dt-published" datetime="2018-05-31T03:14:00+08:00" itemprop="datePublished">2018-05-31</time></p><div class="e-content article-entry" itemprop="articleBody"><h3 id="问题">问题</h3><p>最近写毕业论文，有大量图片需要按照“<code>图[章节号]-[图片号] [图片标题]</code>”的格式生成标题。例如<strong>第2章</strong>第4张图应为“<code>图2-4 某某图片</code>”。</p><p>由于国内论文的某些标准，章节号并不使用阿拉伯数字。因此<strong>第二章</strong>第4张图实际自动生成的图片标题会变成“<code>图二-4 某某图片</code>”。</p><a id="more"></a><h3 id="搜索">搜索</h3><p>搜索到了各种奇怪的解决办法。</p><ul><li>纯机械式自己编号</li><li>给每一章设置单独格式，例如第二章设置为“图2”</li><li>每次编完后替换域代码</li><li>使用VBA覆盖InsertCaption()，可惜我对Office的API不熟悉而他提供的代码又不能用</li></ul><p>总之没有找到能用的自动化的方法。</p><h3 id="解决">解决</h3><p>由于本人使用英文版的Office （Microsoft Office Professional Plus 2019 Preview），因此章节标题的默认样式是“Heading 1。”</p><p>基于“Heading 1”自创样式“一级标题”，Numbering设置为“第x章”，应用给所有的章节标题。</p><p>在每个章节标题前插入一个回车，样式设置为“Heading 1”，然后选中将字体Font设置为隐藏。可以用Ctrl+Shift+8查看隐藏掉的部分。</p><p>设置图片标题格式时，前缀选择“Heading 1”。表格同。</p><p>完成。</p><p>对于中文版的Office，解决思路是相同的。只是要注意，图片标题格式中的前缀只支持Word自带的样式，中文模式下我记得就叫“一级标题”。</p></div></div></article></div><div id="privacy-notice"><div id="privacy-notice-content" class="markdown-body"><div><a id="privacy-notice-dismiss" class="btn"><svg width="18" height="18" viewBox="0 0 18 18" style="fill:currentColor;vertical-align:baseline;margin-top:-.3em;margin-bottom:-.3em"><path d="M15 4.41L13.59 3 9 7.59 4.41 3 3 4.41 7.59 9 3 13.59 4.41 15 9 10.41 13.59 15 15 13.59 10.41 9 15 4.41z"/></svg></a></div><div>Hover your mouse or tap on the left edge to navigate.<br>Upon dismissing, you acknowledge that you have read and understand our <a href="/privacy-policy/">Privacy Policy</a>.</div></div></div></body><footer><script src="/content/js/footer.js?v=202102080708"></script></footer></html>